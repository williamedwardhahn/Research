%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% William Hahn
% APSO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function []=Hahn_APSO()

clc
clear all

N  = 10000;  % Steps
n  = 10;  % Agents
ss = 10;
d  = 200;

beta=0.5;

xn=rand(d,n)*(2*ss)-ss;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

alpha=(0.00001).^((1:N)/N);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

delta=randn(N,n,d);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for i = 1:N
    
    zn=f(xn);
    [zn_m,z_i]=min(zn);
    
    x0=xn(:,z_i);
    
    for j = 1 : d
        
        xn(j,:) = xn(j,:).*(1-beta)+ x0(j).*beta + alpha(i).*delta(i,:,j);
        
    end
    
end


x0
zn_m
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function z=f(x)

z=sum((x-7).^2);


%z=(-x(1,:).*sin(sqrt(abs(x(1,:))))-x(2,:).*sin(sqrt(abs(x(2,:))))).*(abs(x(1,:))<500).*(abs(x(2,:))<500);;

%z=20+x(1,:).^2-10.*cos(2.*pi.*x(1,:))+x(2,:).^2-10.*cos(2.*pi.*x(2,:));

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


